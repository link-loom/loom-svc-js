<!DOCTYPE html>
<html lang="en">

<head>
  <title>WS Tests</title>
</head>
<script src="http://localhost:3500/socket.io/socket.io.js"></script>

<body>
  <h1>WS Tests</h1>
  <p>Check console</p>
  <section>
    <button class="server-btn">Send Server Event</button>
    <button class="chatbot-btn">Send Chatbot Event</button>
    <button class="client-btn">Send Client Event</button>
  </section>
  <script>
    const serverUri = "http://localhost:3500/";
    const socket = io(serverUri);
    const serverPayload = {
      context: {
        topics: [],
        event: {
          name: 'reversebytes.beat.server'
        },
        socket: {
          id: socket.id
        }
      },
      command: '#request',
      values: {}
    }
    const chatbotPayload = {
      context: {
        topics: ['chatbot'],
        event: {
          name: 'reversebytes.beat.chatbot'
        },
        socket: {
          id: socket.id
        }
      },
      command: '#request',
      values: {}
    }
    const clientPayload = {
      context: {
        topics: ['client'],
        event: {
          name: 'reversebytes.beat.client'
        },
        socket: {
          id: socket.id
        }
      },
      command: '#request',
      values: {}
    }

    socket.on("connect", () => {
      console.log('connected to server with id: ', socket.id)

      serverPayload.context.socket.id = socket.id
      chatbotPayload.context.socket.id = socket.id
      clientPayload.context.socket.id = socket.id

      socket.emit('reversebytes.beat.server', serverPayload);
      socket.emit('reversebytes.beat.chatbot', chatbotPayload);
      socket.emit('reversebytes.beat.client', clientPayload);
    });

    socket.on('reversebytes.beat.server', (data) => {
      console.log('reversebytes.beat.server: ', data)
    });

    socket.on('reversebytes.beat.chatbot', (data) => {
      console.log('reversebytes.beat.chatbot: ', data)
    });

    socket.on('reversebytes.beat.client', (data) => {
      console.log('reversebytes.beat.client: ', data)
    });

    document.querySelector('.server-btn').onclick = (event) => {
      if (event) { event.preventDefault(); }

      socket.emit('reversebytes.beat.server', serverPayload);
    }

    document.querySelector('.chatbot-btn').onclick = (event) => {
      if (event) { event.preventDefault(); }

      socket.emit('reversebytes.beat.chatbot', chatbotPayload);
    }

    document.querySelector('.client-btn').onclick = (event) => {
      if (event) { event.preventDefault(); }

      socket.emit('reversebytes.beat.client', clientPayload);
    }
  </script>
</body>

</html>